<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5"
    />
    <meta name="author" content="AdminKit" />
    <meta
      name="keywords"
      content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web"
    />

    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link rel="shortcut icon" href="img/icons/icon-48x48.png" />

    <link rel="canonical" href="https://demo-basic.adminkit.io/" />

    <title>Admin Panel</title>

    <link href="../css/admin-css/app.css" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css"
    />
  

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  </head>
<body>
  <div class="wrapper">
    <nav id="sidebar" class="sidebar js-sidebar">
      <div class="sidebar-content js-simplebar">
        <a class="sidebar-brand" href="/admin">
          <span class="align-middle">Admin Panel</span>
        </a>

        <ul class="sidebar-nav">
          <li class="sidebar-header">Pages</li>

          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin">
              <i class="align-middle" data-feather="monitor"></i>
              <span class="align-middle">Dashboard</span>
            </a>
          </li>

          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/products">
              <i class="align-middle" data-feather="shopping-bag"></i>
              <span class="align-middle">Products</span>
            </a>
          </li>

          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/categoryView">
              <i class="align-middle" data-feather="layers"></i>
              <span class="align-middle">Category</span>
            </a>
          </li>
          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/user">
              <i class="align-middle" data-feather="users"></i>
              <span class="align-middle">Users</span>
            </a>
          </li>

          <li class="sidebar-item active">
            <a class="sidebar-link" href="/admin/orderStatus">
              <i class="align-middle" data-feather="package"></i>
              <span class="align-middle">Order Status</span>
            </a>
          </li>

          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/salesReport">
              <i class="align-middle" data-feather="package"></i>
              <span class="align-middle">Sales Report</span>
            </a>
          </li>

          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/coupons">
              <i class="align-middle" data-feather="command"></i>
              <span class="align-middle">Coupons</span>
            </a>
          </li>
          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/offers">
              <i class="align-middle" data-feather="command"></i>
              <span class="align-middle">Offers</span>
            </a>
          </li>
          <li class="sidebar-item">
            <a class="sidebar-link" href="/admin/banner">
              <i class="align-middle" data-feather="bookmark"></i>
              <span class="align-middle">Banner</span>
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="main">
      <nav class="navbar navbar-expand navbar-light navbar-bg">
        <a class="sidebar-toggle js-sidebar-toggle">
          <i class="hamburger align-self-center"></i>
        </a>

        <div class="navbar-collapse collapse">
          <ul class="navbar-nav navbar-align">
            <li class="nav-item dropdown">
              <a
                class="nav-icon dropdown-toggle d-inline-block d-sm-none"
                href="#"
                data-bs-toggle="dropdown"
              >
                <i class="align-middle" data-feather="settings"></i>
              </a>

              <a
                class="nav-link dropdown-toggle d-none d-sm-inline-block"
                href="#"
                data-bs-toggle="dropdown"
              >
                <img
                  src="../images/login-images/avatar.jpg"
                  class="avatar img-fluid rounded me-1"
                  alt="Charles Hall"
                />
                <span class="text-dark">Admin</span>
              </a>
              <div class="dropdown-menu dropdown-menu-end">
                <a class="dropdown-item" href="pages-profile.html"
                  ><i class="align-middle me-1" data-feather="user"></i>
                  Profile</a
                >
                <a class="dropdown-item" href="#"
                  ><i class="align-middle me-1" data-feather="pie-chart"></i>
                  Analytics</a
                >
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="index.html"
                  ><i class="align-middle me-1" data-feather="settings"></i>
                  Settings & Privacy</a
                >
                <a class="dropdown-item" href="#"
                  ><i class="align-middle me-1" data-feather="help-circle"></i>
                  Help Center</a
                >
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="/logout">Log out</a>
              </div>
            </li>
          </ul>
        </div>
      </nav>

      <main class="content">

       
            <style>
              .btn-success {
              background-color: rgb(6, 72, 119);
              border-color: rgb(6, 72, 119);
            }
            
          .table-responsive {
            height: 100%;
            overflow-y: auto;
          }
        
          .reason-text {
          font-style: italic;
          color: red;
          /* Add any additional styling as desired */
        }
        
            .my-btn {
                background-color: #28a745;
                color: #fff;
                border-color: #28a745;
              }
              
              .my-btn:hover {
                background-color: #218838;
                border-color: #1e7e34;
              }

              .custom-table {
  width: 100%;
  border-collapse: collapse;
}



            
            </style>
           
            <div class="container-fluid">
                <div class="row">
                  <div class="col-md-12">
                    <div class="table-responsive" style="overflow: auto; max-height:100%;">
                      <table class="table table-striped table-bordered  mt-5" id="myTable">
                        <thead class="thead-dark">
                          <tr style="width: fit-content">
                            <th scope="col">No</th>
                            <th scope="col">Order Date</th>
                            <th scope="col">User</th>
                            <th scope="col">Product</th>
                            <th scope="col">Name of receiver</th>
                            <th scope="col">Address</th>
                            <th scope="col">Pincode</th>
                            <th>Mobile</th>
                            <th>Total Amount</th>
                            <th>Size</th>

                            <th>Total Quantity</th>
                            <th>Payment Status</th>
                            <th>Delivery Status</th>
                            <th>Payment</th>
                            <th>Order Status</th>
                            <th>Status</th>
                            <th>Option</th>
                          </tr>
                        </thead>
                        <tbody>
                          <% locals.orders.forEach(function(order, index) { %>
                            <% order.products.forEach(prd => { %>
                            <tr>
                              <th scope="row"><%= index + 1 %></th>
                              <td><%= new Date(order.createdAt).toLocaleString('en-US', { month: 'short', day: 'numeric', year: 'numeric', hour12: true }) %></td>
                              <td><%= order.userId.name %></td>
                              <td><%= order.products[0].item.name %></td>
                              <td><%= order.deliveryDetails.firstname %> <%= order.deliveryDetails.lastname %></td>
                              <td><%= order.deliveryDetails.streetaddress %>, <%= order.deliveryDetails.town %>, <%= order.deliveryDetails.state %></td>
                              <td><%= order.deliveryDetails.zip %></td>
                              <td><%= order.deliveryDetails.mobile %></td>
                              <td>₹<%= order.totalAmount %></td>
                              <td><%= order.products[0].size %></td>
                              <td><%= order.products.reduce((total, product) => total + product.quantity, 0) %></td>
                              <td><%= order.paymentstatus %></td>
                              <td><%= prd.deliverystatus %></td>
                              <td><%= order.paymentMethod %></td>
                              <td><% if (order.reason) { %> return requested by user  Reason:(<span class="reason-text"><%= order.reason %></span>) <% } else{ %> <%= prd.orderstatus %> <% } %></td>
        
                              <form action="/admin/order-details/?orderId=<%=order._id %>&productId=<%= prd.item._id %>" method="post">
                                <td>
                                  <select name="deliveryStatus" <%= (prd.orderstatus === 'cancelled' || order.paymentstatus === 'failed') ? 'disabled' : '' %>>
                                    <option value=<%= prd.deliverystatus %>><%= prd.deliverystatus %></option>
                                    <option value="shipped">shipped</option>
                                    <option value="out for delivery">out for delivery</option>
                                    <option value="delivered">delivered</option>
                                    <option value="cancelled">cancelled</option>
                                    <option value="returned">returned</option>
                                  </select>
                                </td>
                                <td>
                                  <% if (prd.orderstatus !== 'cancelled') { %>
                                    <button type="submit" class="btn btn-success">Update</button>
                                   
                                  <% } %>
                                
                                </td>
                              </form>
                            </tr>
                            <% }) %>
                          <% }) %>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
              
              
              <script>
                
              function viewDetails(orderId) {
                // Do something with the order ID, such as redirect to a details page
                window.location.href = "/order/details/" + orderId;
              }
            
            
                $(document).ready( function () {
                $('#myTable').DataTable();
            } );
            
            
            document.getElementById("my-dropdown").addEventListener("change", function () {
                    var selectedValue = this.value;
                    if (selectedValue === "year") {
                        document.getElementById("yearDiv").style.display = "block";
                        document.getElementById("monthDiv").style.display = "none";
                        document.getElementById("dayDiv").style.display = "none";
                    } else if (selectedValue === "month") {
                        document.getElementById("yearDiv").style.display = "block";
                        document.getElementById("monthDiv").style.display = "block";
                        document.getElementById("dayDiv").style.display = "none";
                    } else if (selectedValue === "day") {
                        document.getElementById("yearDiv").style.display = "block";
                        document.getElementById("monthDiv").style.display = "block";
                        document.getElementById("dayDiv").style.display = "block";
                    } else {
                        document.getElementById("yearDiv").style.display = "none";
                        document.getElementById("monthDiv").style.display = "none";
                        document.getElementById("dayDiv").style.display = "none";
                    }
                });
              </script>
        
        </div>
        </div>
        <script src="../js/admin-js/app.js"></script>
        <!-- for highlighting navigation bar items -->
        <script src="/javascripts/js-admin/adminActiveNav.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
        
        
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
        
        <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
        <script>
          $(document).ready( function () {
        $('#myTable').DataTable();
        } );
        </script>

      </main>
    </div>
  </div>
</body>
